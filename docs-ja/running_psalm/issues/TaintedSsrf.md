# TaintedSSRF
潜在的なサーバーサイドリクエストフォージェリ（SSRF）の脆弱性。このルールは、ユーザー制御の入力がネットワークリクエストに渡される可能性がある場合に発生します。

## リスク
信頼できないユーザー入力をネットワークリクエストに渡すことは危険である可能性があります。攻撃者がHTTPリクエストを完全に制御できる場合、内部サービスに接続する可能性があります。これらの性質によっては、セキュリティリスクをもたらす可能性があります（例：バックエンドサービス、管理インターフェース、AWSメタデータなど）。

## 例
```php
<?php
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $_GET['url']);
curl_exec($ch);
curl_close($ch);
```

## 緩和策
SSRF脆弱性の緩和は難しい場合があります。IPを禁止しても、攻撃者が内部DNSに向けられた悪意のあるドメインを作成する可能性があるため、うまくいかない可能性があります。
以下を検討してください：
1. 接続可能なドメインの許可リストを持つ。
2. cURLを内部リソースにアクセスできないプロキシに向ける。

## さらなるリソース
- [OWASPのサーバーサイドリクエストフォージェリに関するWiki](https://owasp.org/www-community/attacks/Server_Side_Request_Forgery)
- [CWE-918](https://cwe.mitre.org/data/definitions/918)
